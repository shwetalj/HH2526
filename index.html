<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLL Unearthed Mission Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .map-container {
            position: relative;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .map-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        /* Grid overlay for positioning */
        .grid-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            display: none;
        }

        .grid-overlay.show {
            display: block;
        }

        .grid-line-h {
            position: absolute;
            width: 100%;
            height: 1px;
            background: rgba(0, 255, 0, 0.3);
            left: 0;
        }

        .grid-line-v {
            position: absolute;
            height: 100%;
            width: 1px;
            background: rgba(0, 255, 0, 0.3);
            top: 0;
        }

        .grid-label {
            position: absolute;
            color: lime;
            font-size: 10px;
            font-weight: bold;
            background: rgba(0, 0, 0, 0.7);
            padding: 2px 4px;
            border-radius: 3px;
        }

        .controls {
            margin: 15px 0;
            text-align: center;
        }

        .toggle-grid {
            background: #ff0000;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin-right: 10px;
        }

        .toggle-grid:hover {
            background: #cc0000;
        }

        .coord-display {
            display: inline-block;
            background: #333;
            color: #0f0;
            padding: 10px 15px;
            border-radius: 5px;
            font-family: monospace;
            margin-left: 10px;
        }

        .map-image {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 10px;
        }

        .marker {
            position: absolute;
            width: 80px;
            height: 80px;
            border: none;
            border-radius: 50%;
            background: #ff0000;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
            display: flex;
            align-items: center;
            justify-content: center;
            transform: translate(-50%, -50%);
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
        }

        .marker:hover {
            transform: translate(-50%, -50%) scale(1.1);
            background: #cc0000;
            box-shadow: 0 0 30px rgba(255, 0, 0, 1);
        }

        .marker-label {
            color: white;
            font-size: 32px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            z-index: 1;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(255, 0, 0, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(255, 0, 0, 0);
            }
        }

        /* Mobile responsive styles */
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }

            .marker {
                width: 40px;
                height: 40px;
            }

            .marker-label {
                font-size: 16px;
            }

            .hint-popup {
                min-width: 200px;
                padding: 10px;
            }

            .hint-popup h3 {
                font-size: 1rem;
            }

            .hint-popup p {
                font-size: 0.85rem;
            }

            @keyframes pulse {
                0% {
                    box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7);
                }
                70% {
                    box-shadow: 0 0 0 5px rgba(255, 0, 0, 0);
                }
                100% {
                    box-shadow: 0 0 0 0 rgba(255, 0, 0, 0);
                }
            }
        }

        /* Extra small devices */
        @media (max-width: 480px) {
            .marker {
                width: 35px;
                height: 35px;
            }

            .marker-label {
                font-size: 14px;
            }

            .map-container {
                padding: 10px;
            }

            body {
                padding: 10px;
            }
        }

        /* Mission Table Styles */
        .mission-table-container {
            max-width: 1400px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .mission-table-container h2 {
            text-align: center;
            color: white;
            margin-bottom: 20px;
            font-size: 2rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .mission-table {
            width: 100%;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            border-collapse: collapse;
        }

        .mission-table thead {
            background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%);
            color: white;
        }

        .mission-table th {
            padding: 15px;
            text-align: left;
            font-weight: bold;
            font-size: 1.1rem;
            border-bottom: 3px solid #aa0000;
        }

        .mission-table th:nth-child(1) {
            width: 8%;
        }

        .mission-table th:nth-child(2) {
            width: 20%;
        }

        .mission-table th:nth-child(3) {
            width: 42%;
        }

        .mission-table th:nth-child(4) {
            width: 30%;
        }

        .mission-table tbody tr {
            transition: background-color 0.3s ease;
        }

        .mission-table tbody tr:hover {
            background-color: #f5f5f5;
        }

        .mission-table tbody tr:nth-child(even) {
            background-color: #fafafa;
        }

        .mission-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .mission-number {
            font-weight: bold;
            color: #ff0000;
            font-size: 1rem;
        }

        .mission-name {
            font-weight: 600;
            color: #333;
        }

        .mission-desc {
            color: #666;
            line-height: 1.4;
        }

        .mission-points {
            font-weight: 600;
            color: #333;
            text-align: left;
            line-height: 1.5;
            font-size: 0.9rem;
        }

        /* Responsive table for tablets */
        @media (max-width: 768px) {
            .mission-table-container h2 {
                font-size: 1.5rem;
            }

            .mission-table th {
                padding: 10px;
                font-size: 0.9rem;
            }

            .mission-table td {
                padding: 8px 10px;
                font-size: 0.85rem;
            }

            .mission-table th:nth-child(3),
            .mission-table td:nth-child(3) {
                display: none;
            }
        }

        /* Responsive table for mobile */
        @media (max-width: 480px) {
            .mission-table-container {
                padding: 0 10px;
                margin: 20px auto;
            }

            .mission-table {
                font-size: 0.8rem;
            }

            .mission-table thead {
                display: none;
            }

            .mission-table tbody tr {
                display: block;
                margin-bottom: 15px;
                border: 2px solid #ff0000;
                border-radius: 10px;
                padding: 10px;
            }

            .mission-table td {
                display: block;
                text-align: left;
                padding: 5px 10px;
                border: none;
                position: relative;
                padding-left: 40%;
            }

            .mission-table td:before {
                content: attr(data-label);
                position: absolute;
                left: 10px;
                width: 35%;
                font-weight: bold;
                color: #ff0000;
            }

            .mission-table td:nth-child(1):before { content: "Mission:"; }
            .mission-table td:nth-child(2):before { content: "Name:"; }
            .mission-table td:nth-child(3):before { content: "Desc:"; display: none; }
            .mission-table td:nth-child(4):before { content: "Points:"; }

            .mission-table td:nth-child(3) {
                display: none;
            }
        }

        .hint-popup {
            position: absolute;
            background: white;
            border: 2px solid #ff0000;
            border-radius: 10px;
            padding: 15px;
            min-width: 250px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 1000;
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .hint-popup.active {
            display: block;
        }

        .hint-popup h3 {
            color: #ff0000;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .hint-popup p {
            color: #333;
            line-height: 1.5;
            font-size: 0.95rem;
        }

        .hint-popup .close-btn {
            position: absolute;
            top: 5px;
            right: 10px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #999;
        }

        .hint-popup .close-btn:hover {
            color: #ff0000;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .legend {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #ff0000;
        }

        .legend h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .legend-item {
            display: inline-block;
            margin: 5px 15px 5px 0;
            color: #666;
        }

        .legend-marker {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #ff0000;
            border-radius: 50%;
            background: rgba(255, 0, 0, 0.3);
            vertical-align: middle;
            margin-right: 5px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .marker {
                width: 25px;
                height: 25px;
            }
            
            .hint-popup {
                min-width: 200px;
                max-width: 90vw;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>FLL Unearthed Mission Guide</h1>
        
        <div class="map-container">
            <div class="controls">
                <button class="toggle-grid" onclick="toggleGrid()">Toggle Grid</button>
                <span class="coord-display">X: <span id="xCoord">0</span>% | Y: <span id="yCoord">0</span>%</span>
            </div>
            
            <div class="map-wrapper" id="mapWrapper">
                <img src="images/FLL_Unearthed_SETUP.png" alt="FLL Unearthed Game Field" class="map-image" id="fieldImage">
                
                <!-- Grid Overlay -->
                <div class="grid-overlay" id="gridOverlay"></div>
                
                <!-- Mission Markers - Positioned over green squares -->
                <!-- M01 -->
                <div class="marker" style="left: 16%; top: 43%;" data-mission="01">
                    <span class="marker-label">01</span>
                </div>
                
                <!-- M02 -->
                <div class="marker" style="left: 19%; top: 15%;" data-mission="02">
                    <span class="marker-label">02</span>
                </div>
                
                <!-- M03 -->
                <div class="marker" style="left: 37%; top: 13%;" data-mission="03">
                    <span class="marker-label">03</span>
                </div>
                
                <!-- M04 -->
                <div class="marker" style="left: 34%; top: 23%;" data-mission="04">
                    <span class="marker-label">04</span>
                </div>
                
                <!-- M05 -->
                <div class="marker" style="left: 73.5%; top: 13.9%;" data-mission="05">
                    <span class="marker-label">05</span>
                </div>
                
                <!-- M06 -->
                <div class="marker" style="left: 79%; top: 24.7%;" data-mission="06">
                    <span class="marker-label">06</span>
                </div>
                
                <!-- M07 -->
                <div class="marker" style="left: 84.2%; top: 13%;" data-mission="07">
                    <span class="marker-label">07</span>
                </div>
                
                <!-- M08 -->
                <div class="marker" style="left: 83.6%; top: 42.5%;" data-mission="08">
                    <span class="marker-label">08</span>
                </div>
                
                <!-- M09 -->
                <div class="marker" style="left: 65.7%; top: 45.7%;" data-mission="09">
                    <span class="marker-label">09</span>
                </div>
                
                <!-- M10 -->
                <div class="marker" style="left: 58.2%; top: 49.8%;" data-mission="10">
                    <span class="marker-label">10</span>
                </div>
                
                <!-- M11 -->
                <div class="marker" style="left: 58.1%; top: 90.9%;" data-mission="11">
                    <span class="marker-label">11</span>
                </div>
                
                <!-- M12 -->
                <div class="marker" style="left: 46.8%; top: 91%;" data-mission="12">
                    <span class="marker-label">12</span>
                </div>
                
                <!-- M13 -->
                <div class="marker" style="left: 44.2%; top: 44.5%;" data-mission="13">
                    <span class="marker-label">13</span>
                </div>
                
                <!-- M14 -->
                <div class="marker" style="left: 38%; top: 48%;" data-mission="14">
                    <span class="marker-label">14</span>
                </div>
            </div>
            
            <div class="legend">
                <h3>Mission Markers</h3>
                <div class="legend-item">
                    <span class="legend-marker"></span>
                    Click on any red marker to view mission hints and strategies
                </div>
            </div>
        </div>
    </div>

    <!-- Mission Information Table -->
    <div class="mission-table-container">
        <h2>Mission Information</h2>
        <table class="mission-table">
            <thead>
                <tr>
                    <th>Mission #</th>
                    <th>Mission Name</th>
                    <th>Description</th>
                    <th>Points Scoring</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="mission-number">M01</td>
                    <td class="mission-name">Surface Brushing</td>
                    <td class="mission-desc">Brush away sediment to uncover artifacts. Clean and uncover buried artifacts without damaging them.</td>
                    <td class="mission-points">• Soil deposits cleared: 10 pts each<br>• Brush not touching dig site: 10 pts</td>
                </tr>
                <tr>
                    <td class="mission-number">M02</td>
                    <td class="mission-name">Map Reveal</td>
                    <td class="mission-desc">Shift and remove topsoil to reveal sections of a hidden map.</td>
                    <td class="mission-points">• Topsoil sections cleared: 10 pts each</td>
                </tr>
                <tr>
                    <td class="mission-number">M03</td>
                    <td class="mission-name">Mineshaft Explorer</td>
                    <td class="mission-desc">Your team's minecart must pass completely through the mineshaft entry.</td>
                    <td class="mission-points">• Minecart on opposing field: 30 pts<br>• Bonus if opposing cart on your field: +10 pts</td>
                </tr>
                <tr>
                    <td class="mission-number">M04</td>
                    <td class="mission-name">Careful Recovery</td>
                    <td class="mission-desc">Carefully extract the precious artifact from the mine, ensuring the site remains stable.</td>
                    <td class="mission-points">• Artifact not touching mine: 30 pts<br>• Both supports standing: 10 pts</td>
                </tr>
                <tr>
                    <td class="mission-number">M05</td>
                    <td class="mission-name">Who Lived Here?</td>
                    <td class="mission-desc">Rebuild the structure to restore a vital part of the village where people once lived.</td>
                    <td class="mission-points">• Structure floor completely upright: 30 pts</td>
                </tr>
                <tr>
                    <td class="mission-number">M06</td>
                    <td class="mission-name">Forge</td>
                    <td class="mission-desc">Release the ore blocks from the forge. One block holds a mysterious artifact.</td>
                    <td class="mission-points">• Ore blocks not touching forge: 10 pts each</td>
                </tr>
                <tr>
                    <td class="mission-number">M07</td>
                    <td class="mission-name">Heavy Lifting</td>
                    <td class="mission-desc">Move the millstone that was used to process grain.</td>
                    <td class="mission-points">• Millstone not touching base: 30 pts</td>
                </tr>
                <tr>
                    <td class="mission-number">M08</td>
                    <td class="mission-name">Silo</td>
                    <td class="mission-desc">Empty the silo of the preserved food so it can be analyzed at the lab.</td>
                    <td class="mission-points">• Preserved pieces outside silo: 10 pts each</td>
                </tr>
                <tr>
                    <td class="mission-number">M09</td>
                    <td class="mission-name">What's on Sale?</td>
                    <td class="mission-desc">Restore the market stall and reveal items that were once traded.</td>
                    <td class="mission-points">• Roof completely raised: 20 pts<br>• Market wares raised: 10 pts</td>
                </tr>
                <tr>
                    <td class="mission-number">M10</td>
                    <td class="mission-name">Tip the Scales</td>
                    <td class="mission-desc">Use this ancient tool that ensured fair and balanced prices.</td>
                    <td class="mission-points">• Scale tipped & touching mat: 20 pts<br>• Scale pan removed: 10 pts</td>
                </tr>
                <tr>
                    <td class="mission-number">M11</td>
                    <td class="mission-name">Angler Artifacts</td>
                    <td class="mission-desc">Use the crane to excavate artifacts discovered at the port.</td>
                    <td class="mission-points">• Artifacts raised above ground: 20 pts<br>• Bonus if crane flag lowered: +10 pts</td>
                </tr>
                <tr>
                    <td class="mission-number">M12</td>
                    <td class="mission-name">Salvage Operation</td>
                    <td class="mission-desc">Excavate the ancient ship without damaging its delicate structure.</td>
                    <td class="mission-points">• Sand completely cleared: 20 pts<br>• Ship completely raised: 10 pts</td>
                </tr>
                <tr>
                    <td class="mission-number">M13</td>
                    <td class="mission-name">Statue Rebuild</td>
                    <td class="mission-desc">Reconstruct the statue to help piece together its historic significance.</td>
                    <td class="mission-points">• Statue completely raised: 30 pts</td>
                </tr>
                <tr>
                    <td class="mission-number">M14</td>
                    <td class="mission-name">Forum</td>
                    <td class="mission-desc">Deliver artifacts to the forum and choose significant items to display.</td>
                    <td class="mission-points">• Each artifact in forum: 5 pts<br>(Brush, Topsoil, Precious Artifact, Minecart, Ore, Millstone, Scale Pan)</td>
                </tr>
                <tr>
                    <td class="mission-number">M15</td>
                    <td class="mission-name">Site Marking</td>
                    <td class="mission-desc">Place flags to mark locations for further study.</td>
                    <td class="mission-points">• Each site with flag: 10 pts</td>
                </tr>
                <tr>
                    <td class="mission-number">PT</td>
                    <td class="mission-name">Precision Tokens</td>
                    <td class="mission-desc">Start with 6 tokens. Lose one for each robot interruption outside home.</td>
                    <td class="mission-points">1 token: 10 pts<br>2 tokens: 15 pts<br>3 tokens: 25 pts<br>4 tokens: 35 pts<br>5-6 tokens: 50 pts</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Hint Popup -->
    <div class="hint-popup" id="hintPopup">
        <button class="close-btn" onclick="closeHint()">&times;</button>
        <h3 id="hintTitle">Mission Title</h3>
        <p id="hintContent">Mission hint content will appear here.</p>
    </div>

    <script>
        // Create grid overlay
        function createGrid() {
            const gridOverlay = document.getElementById('gridOverlay');
            gridOverlay.innerHTML = '';
            
            // Create horizontal lines every 10%
            for (let i = 0; i <= 100; i += 10) {
                const line = document.createElement('div');
                line.className = 'grid-line-h';
                line.style.top = i + '%';
                
                const label = document.createElement('div');
                label.className = 'grid-label';
                label.style.top = i + '%';
                label.style.left = '5px';
                label.textContent = i + '%';
                
                gridOverlay.appendChild(line);
                gridOverlay.appendChild(label);
            }
            
            // Create vertical lines every 10%
            for (let i = 0; i <= 100; i += 10) {
                const line = document.createElement('div');
                line.className = 'grid-line-v';
                line.style.left = i + '%';
                
                const label = document.createElement('div');
                label.className = 'grid-label';
                label.style.left = i + '%';
                label.style.top = '5px';
                label.textContent = i + '%';
                
                gridOverlay.appendChild(line);
                gridOverlay.appendChild(label);
            }
        }
        
        // Toggle grid visibility
        function toggleGrid() {
            const gridOverlay = document.getElementById('gridOverlay');
            gridOverlay.classList.toggle('show');
        }
        
        // Track mouse coordinates
        document.addEventListener('DOMContentLoaded', function() {
            createGrid();
            
            const mapWrapper = document.getElementById('mapWrapper');
            const xCoord = document.getElementById('xCoord');
            const yCoord = document.getElementById('yCoord');
            
            mapWrapper.addEventListener('mousemove', function(e) {
                const rect = mapWrapper.getBoundingClientRect();
                const x = ((e.clientX - rect.left) / rect.width * 100).toFixed(1);
                const y = ((e.clientY - rect.top) / rect.height * 100).toFixed(1);
                
                xCoord.textContent = x;
                yCoord.textContent = y;
            });
            
            // Click to log coordinates
            mapWrapper.addEventListener('click', function(e) {
                if (e.target.closest('.marker')) return;
                
                const rect = mapWrapper.getBoundingClientRect();
                const x = ((e.clientX - rect.left) / rect.width * 100).toFixed(1);
                const y = ((e.clientY - rect.top) / rect.height * 100).toFixed(1);
                
                console.log(`Clicked at: X: ${x}%, Y: ${y}%`);
            });
        });
        
        // Mission data with hints
        const missionData = {
            '01': {
                title: 'Mission 01: Equipment Inspection',
                hint: 'Push both inspection models completely past their inspection space lines. Tip: Use a wide attachment to push both models simultaneously for efficiency.'
            },
            '02': {
                title: 'Mission 02: Oil Drilling',
                hint: 'Extract oil samples by activating the pump mechanism. Strategy: Approach from the side for better alignment and use consistent motor power.'
            },
            '03': {
                title: 'Mission 03: Energy Storage',
                hint: 'Place energy units in the designated storage area. Consider using a scoop attachment to carry multiple units in one trip.'
            },
            '04': {
                title: 'Mission 04: Solar Farm',
                hint: 'Remove the solar panel units from their holders. Tip: A gentle lifting motion works better than pulling directly.'
            },
            '05': {
                title: 'Mission 05: Smart Grid',
                hint: 'Connect the power nodes to complete the circuit. Use precise movements and consider the order of connections.'
            },
            '06': {
                title: 'Mission 06: Hybrid Car',
                hint: 'Move the hybrid car to the charging station. Align your robot parallel to the car for better control during pushing.'
            },
            '07': {
                title: 'Mission 07: Wind Turbine',
                hint: 'Release the wind turbine blades. A rotating attachment can help activate the release mechanism efficiently.'
            },
            '08': {
                title: 'Mission 08: Power Plant',
                hint: 'Convert energy units at the power plant. Time your approach to avoid interference with other missions.'
            },
            '09': {
                title: 'Mission 09: Dinosaur Discovery',
                hint: 'Carefully extract the dinosaur fossil. Use slow, controlled movements to prevent damage to the model.'
            },
            '10': {
                title: 'Mission 10: Geothermal Energy',
                hint: 'Activate the geothermal plant mechanism. Consider the weight distribution of your robot when applying force.'
            },
            '11': {
                title: 'Mission 11: Innovation Project',
                hint: 'Deliver your innovation model to the designated area. Practice the delivery motion to ensure smooth placement.'
            },
            '12': {
                title: 'Mission 12: Precision Tokens',
                hint: 'Collect precision tokens throughout your run. Plan your route to maximize token collection while completing other missions.'
            },
            '13': {
                title: 'Mission 13: Research Station',
                hint: 'Activate the research station mechanism. Approach from the correct angle to ensure proper engagement with the trigger.'
            },
            '14': {
                title: 'Mission 14: Sample Collection',
                hint: 'Collect and deliver samples to the designated area. Use a secure container attachment to prevent samples from falling during transport.'
            }
        };

        // Get all markers
        const markers = document.querySelectorAll('.marker');
        const hintPopup = document.getElementById('hintPopup');
        const hintTitle = document.getElementById('hintTitle');
        const hintContent = document.getElementById('hintContent');

        // Add click event to each marker
        markers.forEach(marker => {
            marker.addEventListener('click', function(e) {
                e.stopPropagation();
                const missionId = this.getAttribute('data-mission');
                const mission = missionData[missionId];
                
                if (mission) {
                    showHint(mission, this);
                }
            });
        });

        function showHint(mission, markerElement) {
            hintTitle.textContent = mission.title;
            hintContent.textContent = mission.hint;
            
            // Position the popup near the marker
            const rect = markerElement.getBoundingClientRect();
            const popupWidth = 250;
            
            let left = rect.left + window.scrollX + 40;
            let top = rect.top + window.scrollY;
            
            // Adjust if popup would go off screen
            if (left + popupWidth > window.innerWidth) {
                left = rect.left + window.scrollX - popupWidth - 10;
            }
            
            hintPopup.style.left = left + 'px';
            hintPopup.style.top = top + 'px';
            hintPopup.classList.add('active');
        }

        function closeHint() {
            hintPopup.classList.remove('active');
        }

        // Close popup when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.marker') && !e.target.closest('.hint-popup')) {
                closeHint();
            }
        });

        // Handle window resize
        window.addEventListener('resize', function() {
            closeHint();
        });
    </script>
</body>
</html>